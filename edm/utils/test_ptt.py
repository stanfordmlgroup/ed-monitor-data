import unittest

import numpy as np
from edm.utils.ptt import get_ptt

SAMPLE_ECG = np.array([0.27430665, 0.24348425, 0.2162621, 0.195926, 0.1874581, 0.17964466, 0.18223045, 0.17656687, 0.18057459,
              0.16663151, 0.23595697, 0.35253514, 0.74622643, 1.07263487, 0.61887254, 0.23602206, 0.21511118,
              0.21852114, 0.19033379, 0.18910984, 0.18421216, 0.18669989, 0.18985664, 0.19716009, 0.19507156,
              0.20620038, 0.20587087, 0.21437672, 0.22089321, 0.23348083, 0.24036859, 0.25417852, 0.26820717,
              0.28294935, 0.29218513, 0.30001369, 0.30919916, 0.30879282, 0.30625671, 0.30167289, 0.30397043,
              0.29088374, 0.28509277, 0.27736083, 0.26057271, 0.24678961, 0.23757887, 0.2320052, 0.22624605, 0.21529509,
              0.21826271, 0.22280632, 0.22516634, 0.22275172, 0.2230594, 0.22072623, 0.21781379, 0.22373792, 0.2412139,
              0.24279359, 0.26961689, 0.28475225, 0.32096367, 0.34468238, 0.30275241, 0.25966941, 0.25151808,
              0.22577496, 0.19245856, 0.17076826, 0.15769781, 0.14680554, 0.14541595, 0.14256959, 0.14595136,
              0.13048449, 0.18126133, 0.29199568, 0.6501788, 1.10513313, 0.72222457, 0.22021118, 0.14623771, 0.16996905,
              0.14439473, 0.13524829, 0.12717739, 0.13117209, 0.12731602, 0.12799085, 0.12863882, 0.13482511,
              0.14145883, 0.15045912, 0.16058925, 0.15875695, 0.17108317, 0.1844052, 0.20914364, 0.21056993, 0.22038302,
              0.22939348, 0.23454792, 0.23155484, 0.23683187, 0.22920614, 0.22919689, 0.216743, 0.20297162, 0.18514856,
              0.17777708, 0.15430104, 0.13946519, 0.13129911, 0.13110679, 0.12405366, 0.12518132, 0.1278887, 0.12790967,
              0.12237615, 0.12708785, 0.12316272, 0.11950099, 0.12019767, 0.14180342])
SAMPLE_PPG = np.array([2115.0, 2101.0, 2086.0, 2063.0, 2039.0, 2004.0, 1968.0, 1928.0, 1887.0, 1848.0, 1809.0, 1778.0, 1747.0,
              1724.0, 1701.0, 1679.0, 1656.0, 1626.0, 1595.0, 1549.0, 1502.0, 1444.0, 1385.0, 1329.0, 1273.0, 1246.0,
              1218.0, 1239.0, 1259.0, 1340.0, 1421.0, 1550.0, 1679.0, 1834.0, 1988.0, 2135.0, 2281.0, 2395.0, 2508.0,
              2576.0, 2643.0, 2671.0, 2699.0, 2698.0, 2696.0, 2683.0, 2670.0, 2650.0, 2629.0, 2606.0, 2582.0, 2551.0,
              2520.0, 2481.0, 2442.0, 2398.0, 2354.0, 2312.0, 2269.0, 2235.0, 2200.0, 2177.0, 2154.0, 2141.0, 2127.0,
              2116.0, 2105.0, 2091.0, 2076.0, 2051.0, 2026.0, 1992.0, 1958.0, 1918.0, 1878.0, 1841.0, 1804.0, 1774.0,
              1743.0, 1722.0, 1700.0, 1678.0, 1656.0, 1628.0, 1599.0, 1553.0, 1507.0, 1450.0, 1393.0, 1338.0, 1282.0,
              1253.0, 1224.0, 1242.0, 1260.0, 1337.0, 1414.0, 1539.0, 1664.0, 1817.0, 1969.0, 2115.0, 2261.0, 2375.0,
              2489.0, 2559.0, 2629.0, 2658.0, 2686.0, 2687.0, 2687.0, 2673.0, 2659.0, 2639.0, 2618.0, 2594.0, 2569.0,
              2539.0, 2509.0, 2471.0, 2433.0, 2393.0, 2352.0, 2311.0, 2270.0])


class TestPtt(unittest.TestCase):

    def test(self):
        ptt = get_ptt(SAMPLE_PPG, SAMPLE_ECG)
        self.assertEqual(236.0, ptt)


if __name__ == '__main__':
    unittest.main()
